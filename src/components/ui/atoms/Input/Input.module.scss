/* Input.module.scss */
@use 'sass:map';
@use 'sass:meta';
@use 'sass:list';
@use 'sass:string';
@use '../../../../styles/mixins' as *;

$input-colors: (
  primary: (
    solid: (
      bg: var(--project-color-primary-input-solid-bg),
      color: var(--project-color-primary-input-solid-text),
      placeholder: var(--project-color-primary-input-solid-placeholder),
      icon-color: var(--project-color-primary-input-solid-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-primary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-primary-input-outline-bg),
      color: var(--project-color-primary-input-outline-text),
      border: var(--project-color-primary-input-outline-border),
      placeholder: var(--project-color-primary-input-outline-placeholder),
      icon-color: var(--project-color-primary-input-outline-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-primary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),
  secondary: (
    solid: (
      bg: var(--project-color-secondary-input-solid-bg),
      color: var(--project-color-secondary-input-solid-text),
      placeholder: var(--project-color-secondary-input-solid-placeholder),
      icon-color: var(--project-color-secondary-input-solid-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-secondary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-secondary-input-outline-bg),
      color: var(--project-color-secondary-input-outline-text),
      border: var(--project-color-secondary-input-outline-border),
      placeholder: var(--project-color-secondary-input-outline-placeholder),
      icon-color: var(--project-color-secondary-input-outline-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-secondary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),
  tertiary: (
    solid: (
      bg: var(--project-color-tertiary-input-solid-bg),
      color: var(--project-color-tertiary-input-solid-text),
      placeholder: var(--project-color-tertiary-input-solid-placeholder),
      icon-color: var(--project-color-tertiary-input-solid-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-tertiary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-tertiary-input-outline-bg),
      color: var(--project-color-tertiary-input-outline-text),
      border: var(--project-color-tertiary-input-outline-border),
      placeholder: var(--project-color-tertiary-input-outline-placeholder),
      icon-color: var(--project-color-tertiary-input-outline-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-tertiary-input-shadow-hover),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),

  success: (
    solid: (
      bg: var(--project-color-input-solid-success-bg),
      color: var(--project-color-input-solid-success-text),
      placeholder: var(--project-color-input-solid-success-placeholder),
      icon-color: var(--project-color-input-solid-success-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-success-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-input-outline-success-bg),
      color: var(--project-color-input-outline-success-text),
      border: var(--project-color-input-outline-success-border),
      placeholder: var(--project-color-input-outline-success-placeholder),
      icon-color: var(--project-color-input-outline-success-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-success-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),
  warning: (
    solid: (
      bg: var(--project-color-input-solid-warning-bg),
      color: var(--project-color-input-solid-warning-text),
      placeholder: var(--project-color-input-solid-warning-placeholder),
      icon-color: var(--project-color-input-solid-warning-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-warning-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-input-outline-warning-bg),
      color: var(--project-color-input-outline-warning-text),
      border: var(--project-color-input-outline-warning-border),
      placeholder: var(--project-color-input-outline-warning-placeholder),
      icon-color: var(--project-color-input-outline-warning-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-warning-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),
  danger: (
    solid: (
      bg: var(--project-color-input-solid-danger-bg),
      color: var(--project-color-input-solid-danger-text),
      placeholder: var(--project-color-input-solid-danger-placeholder),
      icon-color: var(--project-color-input-solid-danger-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-danger-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
    outline: (
      bg: var(--project-color-input-outline-danger-bg),
      color: var(--project-color-input-outline-danger-text),
      border: var(--project-color-input-outline-danger-border),
      placeholder: var(--project-color-input-outline-danger-placeholder),
      icon-color: var(--project-color-input-outline-danger-icon-fill),
      hover: (
        shadow: 0 0 0 rem(4px) var(--project-color-input-danger-hover-shadow),
      ),
      disabled: (
        bg: var(--project-color-input-disabled-bg),
        color: var(--project-color-input-disabled-text),
        border: var(--project-color-input-disabled-border),
        placeholder: var(--project-color-input-disabled-placeholder),
      ),
      readonly: (
        bg: var(--project-color-input-readonly-bg),
        color: var(--project-color-input-readonly-text),
        border: var(--project-color-input-readonly-border),
        placeholder: var(--project-color-input-readonly-placeholder),
      ),
    ),
  ),
);

$input-sizes: (
  xs: (
    width: rem(200px),
    height: rem(32px),
    padding: 0 rem(8px),
    font-token: var(--project-typo-input-3-500),
    radius: rem(var(--project-border-radius-4)),
    adorned-start: (
      padding: 0 rem(8px) 0 0,
    ),
    adorned-end: (
      padding: 0 0 0 rem(8px),
    ),
  ),
  sm: (
    width: rem(260px),
    height: rem(36px),
    padding: 0 rem(10px),
    font-token: var(--project-typo-input-2-500),
    radius: rem(var(--project-border-radius-6)),
    adorned-start: (
      padding: 0 rem(10px) 0 0,
    ),
    adorned-end: (
      padding: 0 0 0 rem(10px),
    ),
  ),
  md: (
    width: rem(320px),
    height: rem(40px),
    padding: 0 rem(12px),
    font-token: var(--project-typo-input-2-500),
    radius: rem(var(--project-border-radius-6)),
    adorned-start: (
      padding: 0 rem(12px) 0 0,
    ),
    adorned-end: (
      padding: 0 0 0 rem(12px),
    ),
  ),
  lg: (
    width: rem(480px),
    height: rem(44px),
    padding: 0 rem(14px),
    font-token: var(--project-typo-input-1-500),
    radius: rem(var(--project-border-radius-8)),
    adorned-start: (
      padding: 0 rem(14px) 0 0,
    ),
    adorned-end: (
      padding: 0 0 0 rem(14px),
    ),
  ),
  xl: (
    width: 100%,
    height: rem(48px),
    padding: 0 rem(16px),
    font-token: var(--project-typo-input-1-500),
    radius: rem(var(--project-border-radius-8)),
    adorned-start: (
      padding: 0 rem(16px) 0 0,
    ),
    adorned-end: (
      padding: 0 0 0 rem(16px),
    ),
  ),
);

// mixin - input variant [color + variant]
@mixin input-variant($variant) {
  &:global(.variant--#{$variant}) {
    @each $name, $props in $input-colors {
      $variant-props: map.get($props, $variant);
      $readonly-props: map.get($variant-props, readonly);
      $disabled-props: map.get($variant-props, disabled);
      $hover-props: map.get($variant-props, hover);
      $shadow-value: map.get($hover-props, shadow);

      @if $variant-props != null {
        &:global(.color--#{$name}) {
          &:not(:has(input:disabled, input:read-only)):hover {
            box-shadow: $shadow-value;
          }

          // variant
          @if $variant == 'solid' {
            &:global(.variant--solid) {
              background-color: map.get($variant-props, bg);
              color: map.get($variant-props, color);

              &::placeholder {
                color: map.get($variant-props, placeholder);
              }

              :global(.icon) {
                color: map.get($variant-props, icon-color);
              }

              &:global(:has(input:read-only:not(:disabled))) {
                :global(.icon) {
                  color: map.get($readonly-props, placeholder);
                }
              }

              &:global(:has(input:disabled)) {
                :global(.icon) {
                  color: map.get($disabled-props, placeholder);
                }
              }

              :global(input) {
                &:disabled {
                  background-color: map.get($disabled-props, bg);
                  color: map.get($disabled-props, color);

                  &::placeholder {
                    color: map.get($disabled-props, placeholder) !important;
                  }
                }

                &:read-only:not(:disabled) {
                  background-color: map.get($readonly-props, bg);
                  color: map.get($readonly-props, color);

                  &::placeholder {
                    color: map.get($readonly-props, placeholder);
                  }
                }
              }

              // 만약 input이 disabled일 때 부모 요소 컬러 변경
              &:has(input:disabled) {
                background-color: map.get($disabled-props, bg);
              }

              &:has(input:read-only:not(:disabled)) {
                background-color: map.get($readonly-props, bg);
              }
            }
          } @else if $variant == 'outline' {
            &:global(.variant--outline) {
              background-color: map.get($variant-props, bg);
              color: map.get($variant-props, color);
              border: rem(1px) solid map.get($variant-props, border);

              &::placeholder {
                color: map.get($variant-props, placeholder);
              }

              :global(.icon) {
                color: map.get($variant-props, icon-color);
              }

              &:global(:has(input:read-only:not(:disabled))) {
                :global(.icon) {
                  color: map.get($readonly-props, placeholder);
                }
              }

              &:global(:has(input:disabled)) {
                :global(.icon) {
                  color: map.get($disabled-props, placeholder);
                }
              }

              :global(input) {
                &:disabled {
                  background-color: map.get($disabled-props, bg);
                  color: map.get($disabled-props, color);

                  &::placeholder {
                    color: map.get($disabled-props, placeholder) !important;
                  }
                }

                &:read-only:not(:disabled) {
                  background-color: map.get($readonly-props, bg);
                  color: map.get($readonly-props, color);

                  &::placeholder {
                    color: map.get($readonly-props, placeholder);
                  }
                }
              }

              // 만약 input이 disabled일 때 부모 요소 컬러 변경
              &:has(input:disabled) {
                background-color: map.get($disabled-props, bg);
                border: rem(1px) solid map.get($disabled-props, border);
              }

              &:has(input:read-only:not(:disabled)) {
                background-color: map.get($readonly-props, bg);
                border: rem(1px) solid map.get($readonly-props, border);
              }
            }
          }

          :global(input::placeholder) {
            color: map.get($variant-props, placeholder);
          }
        }
      }
    }
  }
}

.input {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  position: relative;
  transition: all 0.2s ease;

  &:is(label) {
    outline: none !important;
  }

  &:global(.pseudo-focus-visible) {
    input {
      outline: 2.5px dashed #2466eb !important;
      outline-offset: 0px;
    }
  }

  :global(button) {
    flex: 0 0 auto;
  }

  &:global(.adorned-start) {
    :global(button) {
      border-top-left-radius: inherit !important;
      border-top-right-radius: 0 !important;
      border-bottom-right-radius: 0 !important;
      border-bottom-left-radius: inherit !important;

      &:focus-visible,
      &:focus {
        outline-offset: -2px;
      }
    }

    :global(input) {
      border-top-left-radius: 0;
      border-top-right-radius: inherit;
      border-bottom-right-radius: inherit;
      border-bottom-left-radius: 0;

      &:focus-visible,
      &:focus {
        outline-offset: -2px;
      }
    }
  }

  &:global(.adorned-end) {
    :global(button) {
      border-top-left-radius: 0 !important;
      border-top-right-radius: inherit !important;
      border-bottom-right-radius: inherit !important;
      border-bottom-left-radius: 0 !important;

      &:focus-visible,
      &:focus {
        outline-offset: -2px;
      }
    }

    :global(input) {
      border-top-left-radius: inherit;
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
      border-bottom-left-radius: inherit;

      &:focus-visible,
      &:focus {
        outline-offset: -2px;
      }
    }
  }

  // variant
  @include input-variant(solid);
  @include input-variant(outline);

  // size, shape
  @each $size-name, $props in $input-sizes {
    $adorned-start-map: map.get($props, adorned-start);
    $adorned-end-map: map.get($props, adorned-end);

    &:global(.size--#{$size-name}) {
      width: map.get($props, width);
      height: map.get($props, height);

      &:global(.shape--squre) {
        border-radius: 0;
      }

      &:global(.shape--rounded) {
        border-radius: map.get($props, radius);
      }

      &:global(.shape--pill) {
        border-radius: var(--project-border-radius-max);
      }

      :global(input) {
        padding: map.get($props, padding);
        font: map.get($props, font-token);
      }

      &:global(.adorned-start) {
        :global(input) {
          padding: map.get($adorned-start-map, padding);
        }
      }

      &:global(.adorned-end) {
        :global(input) {
          padding: map.get($adorned-end-map, padding);
        }
      }
    }
  }

  :global(input) {
    width: 100%;
    height: 100%;
    border: none;
    background-color: inherit;
    color: inherit;
    border-radius: inherit;

    @include ell();
  }
}
