/* Spinner.module.scss */
@use 'sass:map';
@use 'sass:meta';
@use '../../../../styles/mixins' as *;

// Spinner Colors
$spinner-colors: (
  // Primary
  primary: (
      open-ring: (
        track: var(--project-color-primary-spinner-open-ring-track-bg),
        path: var(--project-color-primary-spinner-open-ring-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-primary-spinner-closed-ring-track-bg),
        path: var(--project-color-primary-spinner-closed-ring-path-bg),
      ),
    ),
  primary-solid: (
    open-ring: (
      track: var(--project-color-primary-spinner-solid-open-ring-track-bg),
      path: var(--project-color-primary-spinner-solid-open-ring-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-primary-spinner-solid-closed-ring-track-bg),
      path: var(--project-color-primary-spinner-solid-closed-ring-path-bg),
    ),
  ),
  // Secondary
  secondary: (
      open-ring: (
        track: var(--project-color-secondary-spinner-open-ring-track-bg),
        path: var(--project-color-secondary-spinner-open-ring-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-secondary-spinner-closed-ring-track-bg),
        path: var(--project-color-secondary-spinner-closed-ring-path-bg),
      ),
    ),
  secondary-solid: (
    open-ring: (
      track: var(--project-color-secondary-spinner-solid-open-ring-track-bg),
      path: var(--project-color-secondary-spinner-solid-open-ring-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-secondary-spinner-solid-closed-ring-track-bg),
      path: var(--project-color-secondary-spinner-solid-closed-ring-path-bg),
    ),
  ),
  // Tertiary
  tertiary: (
      open-ring: (
        track: var(--project-color-tertiary-spinner-open-ring-track-bg),
        path: var(--project-color-tertiary-spinner-open-ring-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-tertiary-spinner-closed-ring-track-bg),
        path: var(--project-color-tertiary-spinner-closed-ring-path-bg),
      ),
    ),
  tertiary-solid: (
    open-ring: (
      track: var(--project-color-tertiary-spinner-solid-open-ring-track-bg),
      path: var(--project-color-tertiary-spinner-solid-open-ring-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-tertiary-spinner-solid-closed-ring-track-bg),
      path: var(--project-color-tertiary-spinner-solid-closed-ring-path-bg),
    ),
  ),
  // Success
  success: (
      open-ring: (
        track: var(--project-color-spinner-open-ring-success-track-bg),
        path: var(--project-color-spinner-open-ring-success-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-spinner-closed-ring-success-track-bg),
        path: var(--project-color-spinner-closed-ring-success-path-bg),
      ),
    ),
  success-solid: (
    open-ring: (
      track: var(--project-color-spinner-solid-open-ring-success-track-bg),
      path: var(--project-color-spinner-solid-open-ring-success-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-spinner-solid-closed-ring-success-track-bg),
      path: var(--project-color-spinner-solid-closed-ring-success-path-bg),
    ),
  ),
  // Warning
  warning: (
      open-ring: (
        track: var(--project-color-spinner-open-ring-warning-track-bg),
        path: var(--project-color-spinner-open-ring-warning-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-spinner-closed-ring-warning-track-bg),
        path: var(--project-color-spinner-closed-ring-warning-path-bg),
      ),
    ),
  warning-solid: (
    open-ring: (
      track: var(--project-color-spinner-solid-open-ring-warning-track-bg),
      path: var(--project-color-spinner-solid-open-ring-warning-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-spinner-solid-closed-ring-warning-track-bg),
      path: var(--project-color-spinner-solid-closed-ring-warning-path-bg),
    ),
  ),
  // Danger
  danger: (
      open-ring: (
        track: var(--project-color-spinner-open-ring-danger-track-bg),
        path: var(--project-color-spinner-open-ring-danger-path-bg),
      ),
      closed-ring: (
        track: var(--project-color-spinner-closed-ring-danger-track-bg),
        path: var(--project-color-spinner-closed-ring-danger-path-bg),
      ),
    ),
  danger-solid: (
    open-ring: (
      track: var(--project-color-spinner-solid-open-ring-danger-track-bg),
      path: var(--project-color-spinner-solid-open-ring-danger-path-bg),
    ),
    closed-ring: (
      track: var(--project-color-spinner-solid-closed-ring-danger-track-bg),
      path: var(--project-color-spinner-solid-closed-ring-danger-path-bg),
    ),
  )
);

// Spinner Size
$spinner-sizes: (
  xs: (
    size: (
      pc: rem(12px),
      // 버튼 height 28px → spinner 12px
      tablet: rem(12px),
      mobile: rem(12px),
    ),
  ),
  sm: (
    size: (
      pc: rem(14px),
      // 버튼 height 32px → spinner 16px
      tablet: rem(14px),
      mobile: rem(14px),
    ),
  ),
  md: (
    size: (
      pc: rem(16px),
      // 버튼 height 40px → spinner 20px
      tablet: rem(16px),
      mobile: rem(16px),
    ),
  ),
  lg: (
    size: (
      pc: rem(20px),
      // 버튼 height 48px → spinner 24px
      tablet: rem(20px),
      mobile: rem(20px),
    ),
  ),
  xl: (
    size: (
      pc: rem(24px),
      // 버튼 height 56px → spinner 28px
      tablet: rem(24px),
      mobile: rem(24px),
    ),
  ),
);

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

// mixin - spinner sizes
@mixin spinner-size() {
  @each $size-name, $props in $spinner-sizes {
    // ──────────────── 기본 데이터 추출 ────────────────
    $size-map: map.get($props, size);

    $size-pc: map.get($size-map, pc);
    $size-tablet: map.get($size-map, tablet);
    $size-mobile: map.get($size-map, mobile);

    // ──────────────── PC 스타일 ────────────────
    &:global(.size--#{$size-name}) {
      width: $size-pc;
      height: $size-pc;
    }

    // ──────────────── Tablet 스타일 (max-width: 768px) ────────────────
    @media (max-width: 768px) {
      &:global(.size--#{$size-name}) {
        width: $size-tablet;
        height: $size-tablet;
      }
    }

    // ──────────────── Mobile 스타일 (max-width: 480px) ────────────────
    @media (max-width: 480px) {
      &:global(.size--#{$size-name}) {
        width: $size-mobile;
        height: $size-mobile;
      }
    }
  }
}

// mixin - spinner variant (color + shape)
@mixin spinner-variant($variant) {
  &:global(.variant--#{$variant}) {
    @each $name, $props in $spinner-colors {
      $variant-props: map.get($props, $variant);

      @if $variant-props != null {
        &:global(.color--#{$name}) {
          @if $variant == 'open-ring' {
            svg {
              :global(.track) {
                stroke: map.get($variant-props, track);
              }

              :global(.path) {
                stroke: map.get($variant-props, path);
              }
            }
          } @else if $variant == 'closed-ring' {
            svg {
              :global(.track) {
                stroke: map.get($variant-props, track);
              }

              :global(.path) {
                stroke: map.get($variant-props, path);
              }
            }
          }
        }
      } @else {
        @warn "Variant '#{$variant}' not found for spinner '#{$name}'";
      }
    }
  }
}

.spinner {
  display: inline-flex;
  align-items: center;
  justify-content: center;

  svg {
    width: 100%;
    height: 100%;
    transform-origin: center;
    animation: rotate 1s linear infinite;

    :global(.track) {
      fill: none;
      stroke-width: 5;
    }

    :global(.path) {
      fill: none;
      stroke-width: 5;
      stroke-linecap: round;
      stroke-dasharray: 80 40;
      stroke-dashoffset: 0;
    }
  }

  // size
  @include spinner-size();

  // variant
  @include spinner-variant(closed-ring);
  @include spinner-variant(open-ring);
}
