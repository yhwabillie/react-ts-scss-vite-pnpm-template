@use 'sass:map';
@use 'sass:meta';
@use 'sass:math';
@use '../../../../styles/mixins' as *;

// ğŸ’¡ 1. ì»¬ëŸ¬ ì‹œìŠ¤í…œ ì •ì˜
$slider-colors: (
  primary: (
    thumb-bg: var(--project-color-primary-slider-thumb-bg),
    thumb-border: var(--project-color-primary-slider-thumb-border),
    fill-bg: var(--project-color-primary-slider-bg),
  ),
  secondary: (
    thumb-bg: var(--project-color-secondary-slider-thumb-bg),
    thumb-border: var(--project-color-secondary-slider-thumb-border),
    fill-bg: var(--project-color-secondary-slider-bg),
  ),
  tertiary: (
    thumb-bg: var(--project-color-tertiary-slider-thumb-bg),
    thumb-border: var(--project-color-tertiary-slider-thumb-border),
    fill-bg: var(--project-color-tertiary-slider-bg),
  ),
);

$slider-sizes: (
  xs: (
    width: rem(100px),
    thumb-size: rem(14px),
    track-height: rem(5px),
  ),
  sm: (
    width: rem(160px),
    thumb-size: rem(16px),
    track-height: rem(7px),
  ),
  md: (
    width: rem(240px),
    thumb-size: rem(18px),
    track-height: rem(8px),
  ),
  lg: (
    width: rem(320px),
    thumb-size: rem(22px),
    track-height: rem(10px),
  ),
  xl: (
    width: rem(480px),
    thumb-size: rem(24px),
    track-height: rem(12px),
  ),
);

.slider {
  position: relative;
  display: flex;
  align-items: center;

  // ì¸í„°ë™ì…˜ & íˆ´íŒ ë¡œì§ (Disabledê°€ ì•„ë‹ ë•Œë§Œ ì‘ë™)
  &:not(:global(.disabled)) {
    // ì‹¤ì œ ë¸Œë¼ìš°ì € ìƒíƒœ ê°ì§€ (inputì´ activeì¼ ë•Œ ë¶€ëª¨ê°€ ê°ì§€)
    // ìŠ¤í† ë¦¬ë¶ìš© pseudo í´ë˜ìŠ¤ ê°ì§€
    &:global(:has(.native-range-input:active)),
    &:global(:has(.native-range-input.pseudo-active)),
    &:global(:has(.input-wrapper:hover)),
    &:global(:has(.thumb:focus-visible)),
    &:global(:has(.thumb.pseudo-focus-visible)) {
      :global(.thumb) :global(.tooltip) {
        opacity: 1;
        visibility: visible;
        transform: translateX(-50%) translateY(0);
      }
    }
  }

  // Disabled ìƒíƒœ (ê°•ì œ ê³ ì • ìŠ¤íƒ€ì¼)
  &:global(:has(.native-range-input:disabled)) {
    opacity: 0.6;

    :global(.native-range-input) {
      cursor: not-allowed;
    }
    :global(.track) {
      background-color: var(--project-color-slider-track-bg);
      :global(.fill) {
        background-color: var(--disabled-fill-bg-color-slider) !important;
      }
    }
    :global(.thumb) {
      background-color: var(--project-color-slider-bg);
      border-color: var(--disabled-thumb-stroke-color-slider) !important;
      cursor: not-allowed;
      :global(.tooltip) {
        display: none !important;
      }
    }
  }

  @each $size-name, $props in $slider-sizes {
    $t-size: map.get($props, thumb-size);

    &:global(.size--#{$size-name}) {
      width: map.get($props, width);

      :global(.input-wrapper) {
        position: relative;
        width: 100%;
        height: rem(32px);
        display: flex;
        align-items: center;
      }

      :global(.native-range-input) {
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        opacity: 0;
        z-index: 10;
        cursor: pointer;
        appearance: none;
        -webkit-appearance: none;

        &::-webkit-slider-thumb {
          appearance: none;
          width: rem($t-size);
          height: rem($t-size);
        }
      }

      :global(.track) {
        position: absolute;
        width: 100%;
        height: rem(map.get($props, track-height));
        background-color: var(--project-color-slider-track-bg);
        border-radius: var(--project-border-radius-max);
        overflow: hidden;

        :global(.fill) {
          height: 100%;
          border-radius: inherit;
        }
      }

      :global(.thumb) {
        position: absolute;
        width: rem($t-size);
        height: rem($t-size);
        border: 2px solid transparent; // ì•„ë˜ ì»¬ëŸ¬ ë£¨í”„ì—ì„œ ì¹ í•¨
        border-radius: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;

        :global(.tooltip) {
          position: absolute;
          bottom: 150%;
          left: 50%;
          transform: translateX(-50%) translateY(rem(8px));
          opacity: 0;
          visibility: hidden;
          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
          padding: rem(4px) rem(8px);
          background-color: var(--project-color-slider-bg);
          color: var(--project-color-slider-text);
          border-radius: rem(4px);
          font-size: rem(12px);
          white-space: nowrap;
        }
      }
    }
  }

  @each $name, $color in $slider-colors {
    &:global(.color--#{$name}) {
      :global(.fill) {
        background-color: map.get($color, fill-bg);
      }
      :global(.thumb) {
        border-color: map.get($color, thumb-border);
        background-color: map.get($color, thumb-bg);

        &:focus-visible,
        &:global(.pseudo-focus-visible) {
          outline: 2.5px dashed var(--project-color-interaction-focus-ring) !important;
          outline-offset: 2px;
        }
      }
    }
  }
}
