/* Button.module.scss */
@use 'sass:map';
@use '../../../../styles/mixins' as *;

// Button Colors (웹접근성 기준, 명도 대비 ≥ 4.5:1)
$btn-colors: (
  primary: (
    solid: (
      bg: #0052cc,
      label: #ffffff,
      hover: (
        bg: #0041a8,
        label: #ffffff,
      ),
      active: (
        bg: #003388,
        label: #ffffff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #0052cc,
      hover: (
        bg: rgba(0, 82, 204, 0.1),
        label: #0052cc,
      ),
      active: (
        bg: rgba(0, 82, 204, 0.2),
        label: #0052cc,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #cce0ff,
      label: #0052cc,
      hover: (
        bg: #b3d1ff,
        label: #0052cc,
      ),
      active: (
        bg: #99c2ff,
        label: #0052cc,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #0052cc,
      hover: (
        bg: rgba(0, 82, 204, 0.05),
        label: #0052cc,
      ),
      active: (
        bg: rgba(0, 82, 204, 0.1),
        label: #0052cc,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #0052cc,
      hover: (
        bg: rgba(0, 82, 204, 0.1),
        label: #003d99,
      ),
      active: (
        bg: rgba(0, 82, 204, 0.2),
        label: #002966,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  secondary: (
    solid: (
      bg: #69b2ff,
      label: #003366,
      hover: (
        bg: #4d9aff,
        label: #003366,
      ),
      active: (
        bg: #3382ff,
        label: #003366,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #69b2ff,
      hover: (
        bg: rgba(105, 178, 255, 0.1),
        label: #69b2ff,
      ),
      active: (
        bg: rgba(105, 178, 255, 0.2),
        label: #69b2ff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #e6f2ff,
      label: #003366,
      hover: (
        bg: #d9ebff,
        label: #003366,
      ),
      active: (
        bg: #cce5ff,
        label: #003366,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #003366,
      hover: (
        bg: rgba(0, 51, 102, 0.05),
        label: #003366,
      ),
      active: (
        bg: rgba(0, 51, 102, 0.1),
        label: #003366,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #69b2ff,
      hover: (
        bg: rgba(105, 178, 255, 0.1),
        label: #69b2ff,
      ),
      active: (
        bg: rgba(105, 178, 255, 0.2),
        label: #69b2ff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  tertiary: (
    solid: (
      bg: #e0e0e0,
      label: #333333,
      hover: (
        bg: #cfcfcf,
        label: #333333,
      ),
      active: (
        bg: #bfbfbf,
        label: #333333,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #333333,
      hover: (
        bg: rgba(51, 51, 51, 0.1),
        label: #333333,
      ),
      active: (
        bg: rgba(51, 51, 51, 0.2),
        label: #333333,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #f5f5f5,
      label: #333333,
      hover: (
        bg: #ebebeb,
        label: #333333,
      ),
      active: (
        bg: #e0e0e0,
        label: #333333,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #333333,
      hover: (
        bg: rgba(51, 51, 51, 0.05),
        label: #333333,
      ),
      active: (
        bg: rgba(51, 51, 51, 0.1),
        label: #333333,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #333333,
      hover: (
        bg: rgba(51, 51, 51, 0.1),
        label: #1a1a1a,
      ),
      active: (
        bg: rgba(51, 51, 51, 0.2),
        label: #000000,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  brand: (
    solid: (
      bg: #ff6f61,
      label: #ffffff,
      hover: (
        bg: #e65c50,
        label: #ffffff,
      ),
      active: (
        bg: #cc5044,
        label: #ffffff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #ff6f61,
      hover: (
        bg: rgba(255, 111, 97, 0.1),
        label: #ff6f61,
      ),
      active: (
        bg: rgba(255, 111, 97, 0.2),
        label: #ff6f61,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #ffd9d0,
      label: #ff6f61,
      hover: (
        bg: #ffc4b8,
        label: #ff6f61,
      ),
      active: (
        bg: #ffb0a1,
        label: #ff6f61,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #ff6f61,
      hover: (
        bg: rgba(255, 111, 97, 0.05),
        label: #ff6f61,
      ),
      active: (
        bg: rgba(255, 111, 97, 0.1),
        label: #ff6f61,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #ff6f61,
      hover: (
        bg: rgba(255, 111, 97, 0.1),
        label: #e65c50,
      ),
      active: (
        bg: rgba(255, 111, 97, 0.2),
        label: #cc5044,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  'brand-sub': (
    solid: (
      bg: #6a1b9a,
      label: #ffffff,
      hover: (
        bg: #5a157f,
        label: #ffffff,
      ),
      active: (
        bg: #4b1169,
        label: #ffffff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #6a1b9a,
      hover: (
        bg: rgba(106, 27, 154, 0.1),
        label: #6a1b9a,
      ),
      active: (
        bg: rgba(106, 27, 154, 0.2),
        label: #6a1b9a,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #e1bee7,
      label: #6a1b9a,
      hover: (
        bg: #d4a6dc,
        label: #6a1b9a,
      ),
      active: (
        bg: #c791d0,
        label: #6a1b9a,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #6a1b9a,
      hover: (
        bg: rgba(106, 27, 154, 0.05),
        label: #6a1b9a,
      ),
      active: (
        bg: rgba(106, 27, 154, 0.1),
        label: #6a1b9a,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #6a1b9a,
      hover: (
        bg: rgba(106, 27, 154, 0.1),
        label: #5a157f,
      ),
      active: (
        bg: rgba(106, 27, 154, 0.2),
        label: #4b1169,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  success: (
    solid: (
      bg: #28a745,
      label: #ffffff,
      hover: (
        bg: #218838,
        label: #ffffff,
      ),
      active: (
        bg: #1e7e34,
        label: #ffffff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #28a745,
      hover: (
        bg: rgba(40, 167, 69, 0.1),
        label: #28a745,
      ),
      active: (
        bg: rgba(40, 167, 69, 0.2),
        label: #28a745,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #d4edda,
      label: #28a745,
      hover: (
        bg: #c3e6cb,
        label: #28a745,
      ),
      active: (
        bg: #b1dfbb,
        label: #28a745,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #28a745,
      hover: (
        bg: rgba(40, 167, 69, 0.05),
        label: #28a745,
      ),
      active: (
        bg: rgba(40, 167, 69, 0.1),
        label: #28a745,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #28a745,
      hover: (
        bg: rgba(40, 167, 69, 0.1),
        label: #218838,
      ),
      active: (
        bg: rgba(40, 167, 69, 0.2),
        label: #1e7e34,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),

  warning: (
    solid: (
      bg: #ff9800,
      label: #212121,
      hover: (
        bg: #e68a00,
        label: #212121,
      ),
      active: (
        bg: #cc7a00,
        label: #212121,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #ff9800,
      hover: (
        bg: rgba(255, 152, 0, 0.1),
        label: #ff9800,
      ),
      active: (
        bg: rgba(255, 152, 0, 0.2),
        label: #ff9800,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #fff3e0,
      label: #ff9800,
      hover: (
        bg: #ffe0b2,
        label: #ff9800,
      ),
      active: (
        bg: #ffd699,
        label: #ff9800,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #ff9800,
      hover: (
        bg: rgba(255, 152, 0, 0.05),
        label: #ff9800,
      ),
      active: (
        bg: rgba(255, 152, 0, 0.1),
        label: #ff9800,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #ff9800,
      hover: (
        bg: rgba(255, 152, 0, 0.1),
        label: #e68a00,
      ),
      active: (
        bg: rgba(255, 152, 0, 0.2),
        label: #cc7a00,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),
  danger: (
    solid: (
      bg: #d32f2f,
      label: #ffffff,
      hover: (
        bg: #b72a2a,
        label: #ffffff,
      ),
      active: (
        bg: #9e2424,
        label: #ffffff,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    outline: (
      bg: transparent,
      label: #d32f2f,
      hover: (
        bg: rgba(211, 47, 47, 0.1),
        label: #d32f2f,
      ),
      active: (
        bg: rgba(211, 47, 47, 0.2),
        label: #d32f2f,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    soft: (
      bg: #f8d7da,
      label: #d32f2f,
      hover: (
        bg: #f5b7b9,
        label: #d32f2f,
      ),
      active: (
        bg: #f1a3a5,
        label: #d32f2f,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    ghost: (
      bg: transparent,
      label: #d32f2f,
      hover: (
        bg: rgba(211, 47, 47, 0.05),
        label: #d32f2f,
      ),
      active: (
        bg: rgba(211, 47, 47, 0.1),
        label: #d32f2f,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
    link: (
      bg: transparent,
      label: #d32f2f,
      hover: (
        bg: rgba(211, 47, 47, 0.1),
        label: #b72a2a,
      ),
      active: (
        bg: rgba(211, 47, 47, 0.2),
        label: #9e2424,
      ),
      disabled: (
        bg: #e0e0e0,
        label: #9e9e9e,
      ),
    ),
  ),
);

// button size
$btn-sizes: (
  xs: (
    height: (
      pc: rem(28px),
      tablet: rem(44px),
      mobile: rem(44px),
    ),
    gap: rem(4px),
    font-token: var(--project-typo-btn1-600),
    padding: (
      pc: rem(8px),
      tablet: rem(8px),
      mobile: rem(8px),
    ),
    radius: (
      pc: rem(4px),
      tablet: rem(6px),
      mobile: rem(6px),
    ),
    icon-size: (
      pc: rem(16px),
      tablet: rem(16px),
      mobile: rem(16px),
    ),
  ),

  sm: (
    height: (
      pc: rem(32px),
      tablet: rem(44px),
      mobile: rem(44px),
    ),
    gap: rem(6px),
    font-token: var(--project-typo-btn2-600),
    padding: (
      pc: rem(12px),
      tablet: rem(12px),
      mobile: rem(12px),
    ),
    radius: (
      pc: rem(5px),
      tablet: rem(6px),
      mobile: rem(6px),
    ),
    icon-size: (
      pc: rem(18px),
      tablet: rem(16px),
      mobile: rem(18px),
    ),
  ),

  md: (
    height: (
      pc: rem(40px),
      tablet: rem(44px),
      mobile: rem(48px),
    ),
    gap: rem(8px),
    font-token: var(--project-typo-btn3-600),
    padding: (
      pc: rem(16px),
      tablet: rem(14px),
      mobile: rem(16px),
    ),
    radius: (
      pc: rem(6px),
      tablet: rem(6px),
      mobile: rem(7px),
    ),
    icon-size: (
      pc: rem(20px),
      tablet: rem(18px),
      mobile: rem(20px),
    ),
  ),

  lg: (
    height: (
      pc: rem(48px),
      tablet: rem(48px),
      mobile: rem(52px),
    ),
    gap: rem(10px),
    font-token: var(--project-typo-btn4-700),
    padding: (
      pc: rem(20px),
      tablet: rem(18px),
      mobile: rem(18px),
    ),
    radius: (
      pc: rem(7px),
      tablet: rem(7px),
      mobile: rem(8px),
    ),
    icon-size: (
      pc: rem(22px),
      tablet: rem(20px),
      mobile: rem(20px),
    ),
  ),

  xl: (
    height: (
      pc: rem(56px),
      tablet: rem(56px),
      mobile: rem(56px),
    ),
    gap: rem(12px),
    font-token: var(--project-typo-btn5-700),
    padding: (
      pc: rem(24px),
      tablet: rem(20px),
      mobile: rem(20px),
    ),
    radius: (
      pc: rem(8px),
      tablet: rem(8px),
      mobile: rem(8px),
    ),
    icon-size: (
      pc: rem(24px),
      tablet: rem(22px),
      mobile: rem(22px),
    ),
  ),
);

// mixin - btn colors
@mixin btn-variant($variant) {
  &:global(.variant--#{$variant}) {
    @each $name, $props in $btn-colors {
      $variant-props: map.get($props, $variant);

      @if $variant-props != null {
        &:global(.color--#{$name}) {
          // 기본 색상
          @if $variant == 'link' {
            background-color: transparent;
            color: map.get($variant-props, label);
            fill: map.get($variant-props, label);
            border: none;

            // link 타입 예외 스타일
            padding: 0 rem(8px);
          } @else {
            background-color: map.get($variant-props, bg);
            color: map.get($variant-props, label);
            fill: map.get($variant-props, label);

            @if $variant == 'outline' {
              border-width: rem(1px);
              border-style: solid;
              border-color: map.get($variant-props, label);
            } @else if $variant == 'soft' or $variant == 'ghost' {
              border: none;
            } @else {
              border: none;
            }
          }

          // hover 처리
          &:hover:not([aria-disabled='true']):not(:disabled) {
            $hover-props: map.get($variant-props, hover);
            @if $hover-props != null {
              @if $variant == 'link' {
                background-color: map.get($hover-props, bg);
                text-decoration: underline;
                text-underline-offset: rem(4px);
              } @else {
                background-color: map.get($hover-props, bg);
                color: map.get($hover-props, label);
              }
            }
          }

          // active 처리
          &:active:not([aria-disabled='true']):not(:disabled) {
            $active-props: map.get($variant-props, active);
            @if $active-props != null {
              @if $variant == 'link' {
                background-color: map.get($active-props, bg);
              } @else {
                background-color: map.get($active-props, bg);
                color: map.get($active-props, label);
              }
            }
            transform: scale(0.97);
          }

          // focus 처리
          &:focus-visible {
            outline: rem(3px) dashed #003366;
            outline-offset: rem(2px);
          }

          // disabled 처리
          &[aria-disabled='true'],
          &:disabled {
            cursor: not-allowed;
            pointer-events: none;
            $disabled-props: map.get($variant-props, disabled);

            @if $disabled-props != null {
              @if $variant == 'link' {
                color: map.get($disabled-props, label);
                background-color: map.get($disabled-props, bg);
              } @else {
                background-color: map.get($disabled-props, bg);
                color: map.get($disabled-props, label);
                fill: map.get($disabled-props, label);

                @if $variant == 'outline' {
                  border-color: map.get($disabled-props, label);
                }
              }
            } @else {
            }
          }
        }
      } @else {
        @warn "Variant '#{$variant}' not found for button '#{$name}'";
      }
    }
  }
}

// mixin - btn sizes
@mixin btn-size() {
  @each $size-name, $props in $btn-sizes {
    // ──────────────── 기본 데이터 추출 ────────────────
    $padding: map.get($props, padding);
    $icon-size: map.get($props, icon-size);
    $height-map: map.get($props, height);

    $height-pc: map.get($height-map, pc);
    $height-tablet: map.get($height-map, tablet);
    $height-mobile: map.get($height-map, mobile);

    // ──────────────── PC 스타일 ────────────────
    &:global(.size--#{$size-name}) {
      height: $height-pc;
      padding: 0 map.get($padding, pc);
      gap: map.get($props, gap);

      .btn-label {
        font: map.get($props, font-token);
      }

      svg {
        width: map.get($icon-size, pc);
        height: map.get($icon-size, pc);
      }
    }

    // ──────────────── Tablet 스타일 (max-width: 768px) ────────────────
    @media (max-width: 768px) {
      &:global(.size--#{$size-name}) {
        height: $height-tablet;
        padding: 0 map.get($padding, tablet);

        svg {
          width: map.get($icon-size, tablet);
          height: map.get($icon-size, tablet);
        }
      }
    }

    // ──────────────── Mobile 스타일 (max-width: 480px) ────────────────
    @media (max-width: 480px) {
      &:global(.size--#{$size-name}) {
        height: $height-mobile; // 모바일 최소 44px 이미 map에서 보정됨
        padding: 0 map.get($padding, mobile);

        svg {
          width: map.get($icon-size, mobile);
          height: map.get($icon-size, mobile);
        }
      }
    }
  }
}

// mixins - btn radius
@mixin btn-radius($btn-sizes) {
  &:global(.shape--rounded) {
    @each $size-name, $props in $btn-sizes {
      $radius: map.get($props, radius);

      &:global(.size--#{$size-name}) {
        // PC 기본값
        border-radius: map.get($radius, pc);

        // Tablet 이하
        @media (max-width: 768px) {
          border-radius: map.get($radius, tablet);
        }

        // Mobile 이하
        @media (max-width: 480px) {
          border-radius: map.get($radius, mobile);
        }
      }
    }
  }
}

.btn {
  min-width: rem(44px);
  display: inline-flex;
  justify-content: center;
  align-items: center;
  transition: all 0.2s ease;
  cursor: pointer;
  user-select: none;

  .btn-label {
    min-width: max-content;
  }

  // size
  @include btn-size();

  // variant
  @include btn-variant(solid);
  @include btn-variant(outline);
  @include btn-variant(ghost);
  @include btn-variant(soft);
  @include btn-variant(link);

  // shape
  &:global(.shape--square) {
    border-radius: 0;
  }
  &:global(.shape--rounded) {
    // radius
    @include btn-radius($btn-sizes);
  }
  &:global(.shape--pill) {
    border-radius: var(--project-border-radius-max);
  }
}
