/* SegmentedControl.module.scss */
@use 'sass:map';
@use 'sass:math';
@use 'sass:meta';
@use '../../../../styles/mixins' as *; // rem í•¨ìˆ˜ í¬í•¨

// ğŸ’¡ 1. ì»¬ëŸ¬ ì‹œìŠ¤í…œ ë§µ (ë³´ë¼ìƒ‰ ê³„ì—´ tertiary ë°˜ì˜)
$segmented-colors: (
  primary: (
    bg: var(--project-color-primary-segmented-control-bg),
    indicator-bg: var(--project-color-primary-segmented-control-indicator-bg),
    text-default: var(--project-color-primary-segmented-control-text),
    text-active: var(--project-color-primary-segmented-control-text-active),
  ),
  secondary: (
    bg: var(--project-color-secondary-segmented-control-bg),
    indicator-bg: var(--project-color-secondary-segmented-control-indicator-bg),
    text-default: var(--project-color-secondary-segmented-control-text),
    text-active: var(--project-color-secondary-segmented-control-text-active),
  ),
  tertiary: (
    bg: var(--project-color-tertiary-segmented-control-bg),
    indicator-bg: var(--project-color-tertiary-segmented-control-indicator-bg),
    text-default: var(--project-color-tertiary-segmented-control-text),
    text-active: var(--project-color-tertiary-segmented-control-text-active),
  ),
);

// ğŸ’¡ 2. ì‚¬ì´ì¦ˆ ì‹œìŠ¤í…œ ë§µ (XS ì •ë ¬ ë³´ì • í¬í•¨)
$segmented-sizes: (
  xs: (
    height: rem(28px),
    item-min-width: rem(56px),
    font-size: rem(12px),
    radius: rem(6px),
    gutter: rem(2px),
  ),
  sm: (
    height: rem(32px),
    item-min-width: rem(60px),
    font-size: rem(13px),
    radius: rem(10px),
    gutter: rem(3px),
  ),
  md: (
    height: rem(36px),
    item-min-width: rem(80px),
    font-size: rem(14px),
    radius: rem(10px),
    gutter: rem(3px),
  ),
  lg: (
    height: rem(44px),
    item-min-width: rem(100px),
    font-size: rem(15px),
    radius: rem(12px),
    gutter: rem(4px),
  ),
  xl: (
    height: rem(52px),
    item-min-width: rem(120px),
    font-size: rem(16px),
    radius: rem(14px),
    gutter: rem(5px),
  ),
);

.segmented-control {
  display: flex;
  position: relative;
  width: fit-content;
  box-sizing: border-box;
  overflow: hidden; // ë‚´ë¶€ ìš”ì†Œê°€ ë¶€ëª¨ ê³¡ë¥ ì„ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ í•¨

  // ğŸ’¡ 3. ì»¬ëŸ¬ ë£¨í”„ ì ìš©
  @each $color, $c-props in $segmented-colors {
    &:global(.color--#{$color}) {
      background-color: map.get($c-props, bg);

      :global(.segmented-indicator) {
        background-color: map.get($c-props, indicator-bg);
      }

      :global(.segmented-label) {
        color: map.get($c-props, text-default);
        &:global(.is-active) {
          color: map.get($c-props, text-active);
        }
      }

      &:focus-visible {
        :global(.segmented-indicator) {
          outline: 2.5px solid #2466eb !important;
          outline-offset: 1px;
        }
      }

      &:has(:global(.native-segmented-input:disabled)) {
        background-color: var(--disabled-bg-color-segmented-control);

        :global(.segmented-indicator) {
          background-color: var(--disabled-indicator-color-segmented-control);
        }

        :global(.segmented-item) {
          :global(.segmented-label) {
            color: var(--disabled-text-color-segmented-control);
            cursor: not-allowed;

            &:global(.is-active) {
              color: var(--disabled-text-active-color-segmented-control);
            }
          }
        }
      }
    }
  }

  // ğŸ’¡ 4. ì‚¬ì´ì¦ˆ ë° Shape(Rounded/Pill) ë£¨í”„ ì ìš©
  @each $size, $props in $segmented-sizes {
    &:global(.size--#{$size}) {
      $height: map.get($props, height);
      $gutter: map.get($props, gutter);
      $base-radius: map.get($props, radius);

      --slider-gutter: #{$gutter};
      height: $height;
      padding: $gutter;

      // Rounded í˜•íƒœ
      &:global(.shape--rounded) {
        border-radius: $base-radius;
        :global(.segmented-indicator) {
          border-radius: calc(#{$base-radius} - #{$gutter});
        }
      }

      // Pill í˜•íƒœ (ì•Œì•½)
      &:global(.shape--pill) {
        border-radius: calc(#{$height} / 2);
        :global(.segmented-indicator) {
          border-radius: calc((#{$height} / 2) - #{$gutter});
        }
      }

      :global(.segmented-item) {
        min-width: map.get($props, item-min-width);
      }

      :global(.segmented-label) {
        font-size: map.get($props, font-size);
      }
    }
  }

  // ğŸ’¡ 5. ê³µí†µ ë‚´ë¶€ ìš”ì†Œ ìŠ¤íƒ€ì¼
  :global(.segmented-indicator) {
    position: absolute;
    top: var(--slider-gutter);
    bottom: var(--slider-gutter);
    left: var(--slider-gutter);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 0;
    pointer-events: none;
  }

  :global(.segmented-item) {
    flex: 1;
    min-width: 0;
    position: relative;
    z-index: 1;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;

    :global(.native-segmented-input) {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }

    :global(.segmented-label) {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      padding: 0 rem(4px);
      text-align: center;
      cursor: pointer;
      font-weight: 500;
      transition: color 0.2s;
      white-space: nowrap;
      user-select: none;
    }
  }
}
