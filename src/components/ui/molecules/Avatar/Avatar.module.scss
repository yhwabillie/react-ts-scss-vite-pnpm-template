/* Avatar.module.scss */
@use 'sass:map';
@use '../../../../styles/mixins' as *;

$avatar-sizes: (
  sm: (
    size: rem(32px),
    icon-size: rem(18px),
    font: var(--project-typo-avatar-4-500),
  ),
  md: (
    size: rem(48px),
    icon-size: rem(24px),
    font: var(--project-typo-avatar-3-500),
  ),
  lg: (
    size: rem(64px),
    icon-size: rem(32px),
    font: var(--project-typo-avatar-2-500),
  ),
  xl: (
    size: rem(80px),
    icon-size: rem(40px),
    font: var(--project-typo-avatar-1-500),
  ),
);

$avatar-colors: (
  primary: (
    hover-border: var(--project-color-primary-avatar-hover-border),
    active-border: var(--project-color-primary-avatar-active-border),
  ),
  secondary: (
    hover-border: var(--project-color-secondary-avatar-hover-border),
    active-border: var(--project-color-secondary-avatar-active-border),
  ),
  tertiary: (
    hover-border: var(--project-color-tertiary-avatar-hover-border),
    active-border: var(--project-color-tertiary-avatar-active-border),
  ),
);

.avatar {
  position: relative;
  display: inline-flex;
  border: rem(2px) solid transparent;
  overflow: hidden;
  background-color: var(--project-color-avatar-bg);
  transition: all 0.2s ease;

  @each $size-name, $props in $avatar-sizes {
    @include global-mod('size--#{$size-name}') {
      width: map.get($props, size);
      height: map.get($props, size);

      @include global-mod('shape--square') {
        border-radius: 0;
      }

      @include global-mod('shape--rounded') {
        border-radius: var(--project-border-radius-8);
      }

      @include global-mod('shape--pill') {
        border-radius: var(--project-border-radius-max);
      }

      :global {
        .avatar__fallback {
          font: map.get($props, font);

          :global(.icon) {
            width: map.get($props, icon-size);
            height: map.get($props, icon-size);
          }
        }
      }
    }
  }

  @each $color-name, $variant-map in $avatar-colors {
    // colors
    @include global-mod('color--#{$color-name}') {
      @include global-mod('variant--solid') {
        @at-root button#{&},
          a#{&} {
          &:hover {
            background-color: var(--project-color-avatar-hover-bg);
            box-shadow: 0 rem(4px) rem(10px) 0 var(--project-color-avatar-hover-shadow);
          }

          &:focus-visible,
          &:active {
            transform: scale(0.95);
            background-color: var(--project-color-avatar-hover-bg);
            box-shadow: 0 rem(4px) rem(10px) 0 var(--project-color-avatar-hover-shadow);
          }
        }
      }

      @include global-mod('variant--outline') {
        border-color: var(--project-color-avatar-border);

        @at-root button#{&},
          a#{&} {
          &:hover {
            background-color: var(--project-color-avatar-hover-bg);
            border-color: map.get($variant-map, hover-border);
            box-shadow: 0 rem(4px) rem(10px) 0 var(--project-color-avatar-hover-shadow);
          }

          &:focus-visible,
          &:active {
            transform: scale(0.95);
            background-color: var(--project-color-avatar-hover-bg);
            border-color: map.get($variant-map, active-border);
            box-shadow: 0 rem(4px) rem(10px) 0 var(--project-color-avatar-hover-shadow);
          }
        }
      }
    }
  }

  :global {
    img {
      object-fit: cover;
      user-select: none;
      -webkit-user-drag: none;
    }

    .avatar__fallback {
      display: flex;
      justify-content: center;
      align-self: center;
      flex: 1;
      color: var(--project-color-avatar-fallback-text);
    }
  }
}
