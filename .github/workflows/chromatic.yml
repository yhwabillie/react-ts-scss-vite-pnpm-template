name: 'Chromatic Deployment'

# 1. 언제 실행할지 설정 (main 브랜치에 푸시하거나 PR을 보낼 때)
on:
  push:
    branches:
      - main
  pull_request:

jobs:
  chromatic-deployment:
    runs-on: ubuntu-latest
    steps:
      # 2. 코드 체크아웃
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Chromatic의 히스토리 파악을 위해 필요합니다.

      # 3. 의존성 설치 (npm 또는 yarn 중 사용하는 것에 맞춰 수정하세요)
      - name: Install dependencies
        run: npm install

      # 4. Chromatic 실행
      - name: Publish to Chromatic
        uses: chromaui/action@latest
        with:
          # 아까 추천받은 빌드 대기 시간 단축 옵션
          exitOnceUploaded: true
          # GitHub Secrets에 저장한 토큰 사용
          projectToken: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
